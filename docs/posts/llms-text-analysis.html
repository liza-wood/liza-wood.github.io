<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Liza Wood">
<meta name="dcterms.date" content="2025-08-15">

<title>LLMs for text analysis – Liza Wood</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Liza Wood</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../workshops.html"> 
<span class="menu-text">Workshops / Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../teaching.html"> 
<span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/liza-wood/"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-what-is-a-large-language-model" id="toc-introduction-what-is-a-large-language-model" class="nav-link active" data-scroll-target="#introduction-what-is-a-large-language-model">Introduction: What is a Large Language Model?</a>
  <ul class="collapse">
  <li><a href="#llms-in-research" id="toc-llms-in-research" class="nav-link" data-scroll-target="#llms-in-research">LLMs in research</a></li>
  </ul></li>
  <li><a href="#apis-versus-chat-interfaces" id="toc-apis-versus-chat-interfaces" class="nav-link" data-scroll-target="#apis-versus-chat-interfaces">APIs versus chat interfaces</a></li>
  <li><a href="#working-with-the-api" id="toc-working-with-the-api" class="nav-link" data-scroll-target="#working-with-the-api">Working with the API</a>
  <ul class="collapse">
  <li><a href="#getting-set-up" id="toc-getting-set-up" class="nav-link" data-scroll-target="#getting-set-up">Getting set up</a></li>
  <li><a href="#elements-of-the-query" id="toc-elements-of-the-query" class="nav-link" data-scroll-target="#elements-of-the-query">Elements of the query</a>
  <ul class="collapse">
  <li><a href="#models" id="toc-models" class="nav-link" data-scroll-target="#models">Models</a></li>
  <li><a href="#temperature-top_p-and-max_tokens" id="toc-temperature-top_p-and-max_tokens" class="nav-link" data-scroll-target="#temperature-top_p-and-max_tokens">Temperature, top_p, and max_tokens</a></li>
  <li><a href="#system-instructions" id="toc-system-instructions" class="nav-link" data-scroll-target="#system-instructions">System instructions</a></li>
  <li><a href="#user-prompt" id="toc-user-prompt" class="nav-link" data-scroll-target="#user-prompt">User prompt</a></li>
  <li><a href="#api-key" id="toc-api-key" class="nav-link" data-scroll-target="#api-key">API key</a></li>
  </ul></li>
  <li><a href="#interfacing-with-the-api" id="toc-interfacing-with-the-api" class="nav-link" data-scroll-target="#interfacing-with-the-api">Interfacing with the API</a></li>
  <li><a href="#scaling-queries" id="toc-scaling-queries" class="nav-link" data-scroll-target="#scaling-queries">Scaling queries</a>
  <ul class="collapse">
  <li><a href="#put-it-in-a-function" id="toc-put-it-in-a-function" class="nav-link" data-scroll-target="#put-it-in-a-function">Put it in a function</a></li>
  <li><a href="#rate-limits" id="toc-rate-limits" class="nav-link" data-scroll-target="#rate-limits">Rate limits</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#disclaimers" id="toc-disclaimers" class="nav-link" data-scroll-target="#disclaimers">Disclaimers</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">LLMs for text analysis</h1>
<p class="subtitle lead">Research with the OpenAI API</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Liza Wood </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 15, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction-what-is-a-large-language-model" class="level1">
<h1>Introduction: What is a Large Language Model?</h1>
<p>Talk about Artificial Intelligence is everywhere. From <a href="https://www.nytimes.com/2025/05/14/technology/chatgpt-college-professors.html">university teaching</a>, <a href="https://www.timeshighereducation.com/news/nine-10-uk-undergraduates-now-using-ai-assessments-survey#:~:text=The%20survey%20found%20that%20the,near%2Duniversal%20by%20next%20year">student essays</a>, <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/psj.70034">academic research</a>, <a href="https://www.theguardian.com/technology/2025/may/14/uk-government-ai-consult-consultation">regulatory consultations</a>, and even a whole array of unnecessary appliances like <a href="https://www.oralb.co.uk/en-gb/product-collections/genius-x">toothbrushes</a>.</p>
<p>This post is about AI, and more specifically, Machine Learning (ML) in research. To be self-referential, <a href="claude.ai">claude.ai</a> generated this overview of different ML methods and how they relate. ML covers a wide array of approaches for computer prediction based on ‘learning’ (i.e.&nbsp;giving the computer data). Learning is usually classified into three types: Supervised, Unsupervised, and Reinforcement.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="posts/img/ML-overview.png" class="img-fluid figure-img"></p>
<figcaption>Overview of machine learning concepts, generated by claude.ai</figcaption>
</figure>
</div>
<p>In each of these categories, the figure highlights that various statistical methods that have been around for quite a while fall under the ML umbrella, such as statistical regression (supervised) and Principle Component Analysis (unsupervised). But beyond these traditional approaches, each of these types of learning can use ‘neural networks’ for deep learning.</p>
<p>Neural networks – computational models inspired by neural networks in biology – are typically ‘trained’ (supervised) on data so that it learns how to minimize the difference in the output and the values in the training dataset. One popular software for implementing neural networks is (Keras.io)[https://keras.io/], allowing researchers to train and develop their own predictive models.</p>
<p>The ‘transformer’ architecture behind models like ChatGPT and Claude has evolved from these sorts of neural networks (but critically, rely on a ‘self-attention mechanism’ to predict word sequence). And after being trained on massive amounts of text<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, the resulting Large Language Models (LLMs) are what we can chat with in either an unsupervised fashion (open chats) or supervised fashion (LLMs that are tuned to specific tasks).</p>
<section id="llms-in-research" class="level2">
<h2 class="anchored" data-anchor-id="llms-in-research">LLMs in research</h2>
<p>Now that LLMs have already been trained on huge amounts of data, researchers are able to leverage the learning that has already been done to help assist with research tasks. Researchers are using LLMs in a variety of ways, ranging from synthesizing social data to generating research ideas.</p>
<p>This post is specifically about text classification (and sometimes interpretation) – reading a text and grouping the text according to a decision criteria, or extracting some feature of the text. Specifically, I will be running through how to use OpenAI models for text classification tasks.</p>
</section>
</section>
<section id="apis-versus-chat-interfaces" class="level1">
<h1>APIs versus chat interfaces</h1>
<p>As a starting point, we need to first understand that there are different ways of interacting with LLMs, in this case, OpenAI models. We are likely all familiar with OpenAI’s ChatGPT – the chat interface of its Generate Pre-Trained Transformer. This is where you can interact with the LLM through a chat box, and in these chat sessions the model uses its memory to build on the conversation. We should think of this as the ‘front-end’ interface.</p>
<p>But you can also interface with OpenAI’s models (e.g.&nbsp;GPT-4) through their Application Programming Interface (API). We can think of APIs as ‘back-end’ interfaces that help developers (i.e.&nbsp;people who code) intergated the models into other products. In our case, I am writing for researchers who are developing research software – any workflow that wants to integrate these tools.</p>
<p>I lay out some of the main differences in this presentation I shared with my research group, <a href="https://liza-wood.github.io/posts/img/research_culture_gpt.pdf">‘Reflections of text classification and OpenAI’s (Chat)GPT’</a> and will do so again here, briefly. In short, while the chat interface is the much more user-friendly of the two options, it is very difficult to automate any interaction, and therefore scaling up is difficult. Getting data in and out of the chat, for instance, would rely on a user copying and pasting inputs and outputs. In this way, chats reach memory limits, and the model may behave differently over time as memory is stored. So in general, while it is nice for exploration or quick tasks, it is not a very robust approach for research.</p>
<p>The API, on the other hand, can be automated so that data can be input and output using computer programming. Further, each input can be stand-alone (without building memory) so that the evaluation is more consistent. And for additional consistency, model parameters can be specified through the API to help increase reproducibility for research.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 34%">
<col style="width: 15%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>API</th>
<th>Chat Interface</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Pros</strong></td>
<td>Scalability (via automation), more control over model parameters</td>
<td>User-friendly</td>
</tr>
<tr class="even">
<td><strong>Cons</strong></td>
<td>Requires coding knowledge, setup overhead</td>
<td>Limited automation, manual interaction</td>
</tr>
<tr class="odd">
<td><strong>Best For</strong></td>
<td>Research at large scale</td>
<td>General users, exploration, quick tasks</td>
</tr>
</tbody>
</table>
<p>So we want to be working with API to create scalable, robust text classification. The remainder of this post is about how to do that.</p>
</section>
<section id="working-with-the-api" class="level1">
<h1>Working with the API</h1>
<section id="getting-set-up" class="level2">
<h2 class="anchored" data-anchor-id="getting-set-up">Getting set up</h2>
<p>This post is starting from the very basics, so we are going to walk through the following, step-by-step, to get a user set up. Specifically, I am going to walk through a set-up for a scenario where you may be working with a team with a shared API key.</p>
<ol type="1">
<li>Visit https://platform.openai.com/<br>
</li>
<li>Sign up to create an account (or log in if you already have an account via ChatGPT)<br>
</li>
<li>Navigate to your profile<br>
</li>
<li>Organization &gt; Members &gt; Invite (will need to name your ‘Organization’)<br>
</li>
<li>Navigate to Projects &gt; Create<br>
</li>
<li>Add members to project<br>
</li>
<li>Within the project, navigate to API keys &gt; Create new secret key<br>
</li>
<li>Set up billing</li>
</ol>
<p>Steps 1-2 are fairly self explanatory, so we will start with <strong>Step 3</strong>. On the upper right-hand corner of the page, once you are logged in, you can select your name/photo icon and select ‘Your profile’ to take you to the Settings of your profile.</p>
<p><img src="posts/img/navigate-profile.png" class="img-fluid" alt="Navigate to your profile"> Once you are in your profile, it can be useful to set up an Organization if you plan to work with collaborators. On the left-hand side of the window, under the Organizations subheading, navigate to Members.</p>
<p>You can begin by clicking on the black + Invite button on the main page to invite members to the organization. This will prompt you to name your Organization, if you have not already. After naming your organization you will be able to invite members to the organization by adding their email addresses (<strong>Step 4</strong>).</p>
<p>Once you have created your organization, <strong>Step 5</strong> is to create a Project for you and select members to work on. As OpenAI described, “Projects are shared environments where teams can collaborate and share API resources. You can set custom rate limits and manage access to resources.” To create one, again on the left-hand side navigate to Projects (under the Organization subheading) and clicking on the black + Create button. Give your project a name.</p>
<p>Once your project is created you can add members from your organization to a specific project (<strong>Step 6</strong>). Again on the left-hand side, but now under the Project subheading, navigate to Members and click the black + Add member button. This should allow you to select members from your organization to add to the project.</p>
<p>Now that the organization, membership, and projects are set up, <strong>Step 7</strong> is about setting up your API key. This key is, as named, the passcode that permits a member of the organization to interact with the models you pay for. Under the Project subheading, navigate to API keys and click the black + Create new secret key. This will generate a key that you can only view once, so copy and store it in a protected space. Collaborators on the project should be given this key.</p>
<p>And the final <strong>Step 8</strong> is to add funds to the project by navigating to the Billing section under the Organization subheading. Here you can Add to credit balance the amount of money you want to spend. The balance will be run down as you use the API, according to OpenAI’s <a href="https://openai.com/api/pricing/">pricing model</a>.</p>
<p>As an added element, if there are limits you would like to set on a project, such as budgets (a maximum amount that can be spent in a month) or model limits (which models are to be used in a project), you can do this under the Project’s Limits section.</p>
</section>
<section id="elements-of-the-query" class="level2">
<h2 class="anchored" data-anchor-id="elements-of-the-query">Elements of the query</h2>
<p>To explain what each of these elements are</p>
<section id="models" class="level3">
<h3 class="anchored" data-anchor-id="models">Models</h3>
</section>
<section id="temperature-top_p-and-max_tokens" class="level3">
<h3 class="anchored" data-anchor-id="temperature-top_p-and-max_tokens">Temperature, top_p, and max_tokens</h3>
</section>
<section id="system-instructions" class="level3">
<h3 class="anchored" data-anchor-id="system-instructions">System instructions</h3>
</section>
<section id="user-prompt" class="level3">
<h3 class="anchored" data-anchor-id="user-prompt">User prompt</h3>
</section>
<section id="api-key" class="level3">
<h3 class="anchored" data-anchor-id="api-key">API key</h3>
</section>
</section>
<section id="interfacing-with-the-api" class="level2">
<h2 class="anchored" data-anchor-id="interfacing-with-the-api">Interfacing with the API</h2>
<p>Now that we have defined each of these elements, we can compile them as parameters in a list, which will make up the body of our API request. This API request will eventually be what we ‘send’ to the model, essentially chatting with it as if in the chat interface.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>body <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> modelName,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_tokens =</span> max_tokens,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature =</span> temperature,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">top_p =</span> top_p,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">messages =</span> <span class="fu">list</span>(</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">role =</span> <span class="st">"system"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">content =</span> instructions),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">role =</span> <span class="st">"user"</span>, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">content =</span> prompt)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have we will post a request to the API. The API URL we will be using for chat completions is “https://api.openai.com/v1/chat/completions”. We will also have to authorize our use of the API with our API key, which for the sake of this tutorial is not revealed. We specify that we want to encode the request in the json format, and then we send the body of our request. The result of this request is the response.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">POST</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="st">"https://api.openai.com/v1/chat/completions"</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_headers</span>(<span class="at">Authorization =</span> <span class="fu">paste</span>(<span class="st">"Bearer"</span>, apiKey)),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">content_type_json</span>(),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">encode =</span> <span class="st">"json"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">body =</span>  body</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">status_code</span>(response)<span class="sc">&gt;</span><span class="dv">200</span>) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="fu">content</span>(response))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">content</span>(response)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>answer <span class="ot">&lt;-</span> <span class="fu">trimws</span>(response<span class="sc">$</span>choices[[<span class="dv">1</span>]]<span class="sc">$</span>message<span class="sc">$</span>content)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scaling-queries" class="level2">
<h2 class="anchored" data-anchor-id="scaling-queries">Scaling queries</h2>
<section id="put-it-in-a-function" class="level3">
<h3 class="anchored" data-anchor-id="put-it-in-a-function">Put it in a function</h3>
<p>[FORTHCOMING]</p>
</section>
<section id="rate-limits" class="level3">
<h3 class="anchored" data-anchor-id="rate-limits">Rate limits</h3>
<p>Tokens per minute, requests per minute</p>
</section>
</section>
</section>
<section id="disclaimers" class="level1">
<h1>Disclaimers</h1>
<ul>
<li>I am not an AI expert, and am only writing this post from the perspective of a computational social scientist who entered this space by way of analyzing text data.</li>
<li>OpenAI is <a href="https://www.turing.ac.uk/blog/what-defines-open-open-ai">not, in fact, open</a>. Despite its initial ideas of responsible and open AI, it has switched it model towards a capped for-profit model with exclusive contracts with Microsoft. Open source large language models are available on <a href="https://huggingface.co/">Hugging Face</a>.<br>
</li>
<li>I believe the integration of AI into online search engines is one more step towards the ‘extractive and fragile monoculture’ that is the modern internet, and divesting from big tech and re-wilding the internet is important for maintaining the internet commons (see ‘<a href="https://www.noemamag.com/we-need-to-rewild-the-internet/">We need to rewild the internet</a>’ by Farrell and Berjon).<br>
</li>
<li>The data servers that Generative AI depend on have large <a href="https://news.mit.edu/2025/explained-generative-ai-environmental-impact-0117">environmental consequences</a>. Though researchers have struggled to fully quantify this yet, it is clear that the costs of using AI often outweigh its benefits (i.e.&nbsp;something that could be searched in a classic search engine)</li>
</ul>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>In fact, <a href="https://www.npr.org/2023/12/27/1221821750/new-york-times-sues-chatgpt-openai-microsoft-for-copyright-infringement">OpenAI is in a lawsuit with the <em>New York Times</em></a> for copyright infringement, namely using copyrighted data to train its models. One main critique of LLMs then, is that they has taken text – both from private (copyrighted) and public (internet forums, blogs, etc) sources – and is now capitalizing on this incredible, arguably illegal, enclosure.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>